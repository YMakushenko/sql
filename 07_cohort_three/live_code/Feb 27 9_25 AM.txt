--SELECT & FROM

--SELECT * FROM product

--SELECT 5*10, 1+1, 2024 AS this_year

SELECT customer_first_name, customer_last_name
FROM customer

--WHERE

--SELECT * FROM customer
--WHERE customer_zip = 22801

SELECT * FROM customer
WHERE customer_zip = 22821
--AND customer_first_name = 'Bob'
AND customer_id BETWEEN 3 AND 7 LOL

--CASE

SELECT *
,CASE WHEN cost_to_customer_per_qty < '1.00' THEN cost_to_customer_per_qty*5
ELSE cost_to_customer_per_qty END as inflation

,CASE WHEN (cost_to_customer_per_qty <  AND customer_id = 14) THEN cost_to_customer_per_qty*10
	WHEN cost_to_customer_per_qty BETWEEN '1.01' AND '7.00' THEN cost_to_customer_per_qty*5
	ELSE cost_to_customer_per_qty END as super_inflation

,CASE WHEN cost_to_customer_per_qty < '1.00' THEN 1
--ELSE 0 END as inflation_sorter
END as inflation_sorter

FROM customer_purchases

ORDER BY CASE WHEN cost_to_customer_per_qty < '1.00' THEN 1 ELSE 0 END -- sorting


--DISTINCT

SELECT DISTINCT vendor_id,product_id,customer_id

FROM customer_purchases

ORDER BY vendor_id, product_id, customer_id;

SELECT DISTINCT vendor_id,product_id,customer_id;

FROM customer_purchases
WHERE market_date BETWEEN '2019-04-04' AND '2019-04-30' -- adding this in affects the row counts, now we are only talking about customers who have purchased between these dates

ORDER BY vendor_id, product_id, customer_id;

-- INNER JOIN

/*
SELECT * 

FROM product
INNER JOIN product_category 
	ON product.product_category_id = product_category.product_category_id
*/

SELECT v.*, market_date, product_id, quantity, original_price
FROM vendor v
INNER JOIN vendor_inventory vi
	ON v.vendor_id = vi.vendor_id

-- multiple table joins


/*
SELECT cp.*,p.*,v.*, product_category_name
FROM customer_purchases cp
INNER JOIN product p 
	ON p.product_id = cp.product_id
INNER JOIN vendor v
	ON v.vendor_id = cp.vendor_id
INNER JOIN product_category pc
	ON p.product_category_id = pc.product_category_id
	
	*/
	
SELECT product_category_name, p.*, cp.product_id

FROM product_category as pc
INNER JOIN product as p
	ON p.product_category_id = pc.product_category_id
LEFT JOIN customer_purchases as cp
	ON p.product_id = cp.product_id

